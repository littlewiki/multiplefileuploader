<html>
<head>
	<style>
		@import "../../dojo-release-1.3.0-src/util/doh/robot/robot.css";
		@import "../../dojo-release-1.3.0-src/dijit/themes/nihilo/nihilo.css";		
		@import "../../dojo-release-1.3.0-src/dojo/resources/dojo.css";
	</style>
	<script type="text/javascript" src="../../dojo-release-1.3.0-src/dojo/dojo.js" djConfig="parseOnLoad: true, isDebug:true"></script> 
	<script src="../../dojo-release-1.3.0-src/util/doh/runner.js"></script>
	<script src="../../dojo-release-1.3.0-src/util/doh/robot.js"></script>
<script>
dojo.registerModulePath("multiplefileuploader","../../multiplefileuploader");
	dojo.require("dijit.robot");
	doh.register("doh.robot",
	{
	        lastFileInput: "",
			attachAnImage:"",
			deleteLink: "",
			name:"dojorobot1",
	        timeout:69000,
			filesPath: "C:\\Documents and Settings\\Florent.ZEBULON\\workspace\\multiplefileuploader\\multiplefileuploader\\uploaded",
			setUp:function(){
	       		dojo.require("multiplefileuploader.widget.MultipleFileUploader");			

				var params = {
					ajaxUploadUrl: "http://127.0.0.1/multiplefileuploader/php/uploadToImageServer.php",
					onInputDisplay : dojo.hitch(this, function(fileInput) {
						this._onInputDisplay(fileInput);
					})	
				};
				
				var mfu = new multiplefileuploader.widget.MultipleFileUploader( params, dojo.byId("uploadContainer") ); 

			},
	        runTest:function(){

			
				//console.debug(); 
				 dojo.query(".inputFile").forEach(function(node, index, arr){
    		 		 this.lastFileInput= node;				
				});	
				 dojo.query(".attachAnotherFileLink").forEach(function(node, index, arr){
    		 		 this.attachAnImage= node;				
				});					
			
				
				
				var d = new doh.Deferred();
			   //node, duno, delay, offsetX, offsetY
			   //380 under ff linux
			   //300 under ff windows ...
			    doh.robot.mouseMoveAt(this.lastFileInput,50,300,300,10);
				doh.robot.mouseClick({left:true},100);
doh.robot.keyPress("\\", 500);
	
		

				//doh.robot.typeKeys("robot.css", 500,300);
				doh.robot.keyPress(dojo.keys.ENTER, 500);
				doh.robot.keyPress(dojo.keys.TAB,500);
				return d;
		
	        },
			_onInputDisplay : function(fileInput) {
				this.lastFileInput = fileInput;
			}
			
	});
	doh.run();

</script>

</head>
<body class="nihilo">
<div id="uploadContainer"></div>


</body>
</html>
