/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["multiplefileuploader.widget.MultipleFileUploader"]){dojo._hasResource["multiplefileuploader.widget.MultipleFileUploader"]=true;dojo.provide("multiplefileuploader.widget.MultipleFileUploader");dojo.require("multiplefileuploader.widget.UploadManager");dojo.require("multiplefileuploader.tests.FakeUploadStrategy");dojo.require("multiplefileuploader.tests.FakeUploadStatusStrategy");dojo.require("multiplefileuploader.widget.UploadUnit");dojo.require("multiplefileuploader.widget.UploadUnitContainer");dojo.require("multiplefileuploader.widget.UploadInputPane");dojo.require("dojox.data.dom");dojo.require("dojox.collections.ArrayList");dojo.require("dijit._Templated");dojo.requireLocalization("multiplefileuploader","messages",null,"ROOT,en,fr");multiplefileuploader.widget._uploadContainerMessages=dojo.i18n.getLocalization("multiplefileuploader","messages");dojo.declare("multiplefileuploader.widget.MultipleFileUploader",[dijit._Widget,dijit._Templated],{templateString:"<div>\n\t<div dojoAttachPoint=\"fileUploadContainer\"></div>\n\t<div dojoAttachPoint=\"uploadActionsContainer\"></div>\n</div>\n",ajaxUploadUrl:"",uploadParameterName:"upload",uploadValuePrefix:"uploadedFile_",uploadTimeout:"50000",progressBarMode:true,uploadStatusURL:"",statusParameterName:"statusID",statusTimeout:"",getStatusInterval:"2000",apc_php_enabled:true,inputWidth:40,progressBarWidth:"15%",progressBarHeight:"15px",fakeMode:false,fakeResponse:"",postCreate:function(){this._sanityCheck();var _1={onError:dojo.hitch(this,this._onError),onProgress:dojo.hitch(this,function(_2){this._onProgress(_2);}),onFinishedUploads:dojo.hitch(this,function(){this._onFinishedUploads();}),onFinishedUpload:dojo.hitch(this,function(_3){this._onFinishedUpload(_3);}),onAfterUploadStart:dojo.hitch(this,function(_4){this._onAfterUploadStart(_4);})};if(this.fakeMode){var _5={_uploadStrategy:new multiplefileuploader.tests.FakeUploadStrategy(this.fakeResponse),_uploadStatusStrategy:new multiplefileuploader.tests.FakeUploadStatusStrategy()};dojo.mixin(_1,_5);}var _6={fakeMode:this.fakeMode,fakeResponse:this.fakeResponse};var _7={ajaxUploadUrl:this.ajaxUploadUrl,uploadTimeout:this.uploadTimeout,uploadParameterName:this.uploadParameterName,uploadValuePrefix:this.uploadValuePrefix,apc_php_enabled:this.apc_php_enabled};var _8={uploadStatusURL:this.uploadStatusURL,progressBarMode:this.progressBarMode,getStatusInterval:this.getStatusInterval,checkInterval:this.checkInterval,statusParameterName:this.statusParameterName};var _9={inputWidth:this.inputWidth,progressBarWidth:this.progressBarWidth,progressBarHeight:this.progressBarHeight};this._uploadManager=new multiplefileuploader.widget.UploadManager(_1,_7,_8);var _1={config_status:_8,config_UI:_9,uploadManager:this._uploadManager};this.uploadUnitContainer=new multiplefileuploader.widget.UploadUnitContainer(_1,this.fileUploadContainer,this.uploadActionsContainer);},_sanityCheck:function(){if(this.progressBarMode){if(this.uploadStatusURL==""){throw "When ProgressBarMode enabled, you have to set an uploadStatusURL parameter when instanciate MultipleFileUploader";}}if(this.ajaxUploadUrl==""){throw "you have to provide an ajaxUploadUrl parameter";}},_onError:function(){this.onError();},_onProgress:function(_a){this.onProgress(_a);},_onFinishedUpload:function(_b){this.onFinishedUpload(_b);},_onFinishedUploads:function(){this.onFinishedUploads();},_onAfterUploadStart:function(_c){this.onAfterUploadStart(_c);},onError:function(){},onProgress:function(_d){},onFinishedUploads:function(){},onFinishedUpload:function(_e){},onAfterUploadStart:function(_f){},fireProgress:function(){this._uploadManager.fireProgress();},notifyLastFileInputChanged:function(_10){this.uploadUnitContainer.notifyLastFileInputChanged(_10);}});}