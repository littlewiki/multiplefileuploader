/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["multiplefileuploader.widget.UploadInputPane"]){dojo._hasResource["multiplefileuploader.widget.UploadInputPane"]=true;dojo.provide("multiplefileuploader.widget.UploadInputPane");dojo.require("dijit._Templated");dojo.requireLocalization("multiplefileuploader","messages",null,"ROOT,en,fr");multiplefileuploader.widget._uploadContainerMessages=dojo.i18n.getLocalization("multiplefileuploader","messages");dojo.declare("multiplefileuploader.widget.UploadInputPane",[dijit._Widget,dijit._Templated],{templateString:"<span dojoAttachPoint=\"unitInput\">\n\t  <input dojoAttachPoint=\"inputFile\" type=\"file\" name=\"fileData\"></input>\n\t  <a href=\"#\" dojoAttachPoint=\"deleteLink\">${deleteLink}</a>\n</span>  \n",deleteLink:multiplefileuploader.widget._uploadContainerMessages.deleteFile,postCreate:function(_1){this._eventHandles=new Array([]);this._registerEvents();this._setupUI();},hide:function(){dojo.style(this.unitInput,{display:"none"});},_hideDeleteLink:function(){dojo.style(this.deleteLink,{display:"none"});},_showDeleteLink:function(){dojo.style(this.deleteLink,{display:"inline"});},_registerEvents:function(){this._registerFileInput();this._registerDeleteLink();},_registerFileInput:function(){var _2=dojo.connect(this.inputFile,"onchange",dojo.hitch(this,function(e){dojo.stopEvent(e);this._onFileInputChange();}));this._eventHandles.push(_2);},_registerDeleteLink:function(){var _4=dojo.connect(this.deleteLink,"onclick",dojo.hitch(this,function(e){dojo.stopEvent(e);this._onClickDeleteLink();}));this._eventHandles.push(_4);},_unregisterEvents:function(){dojo.forEach(this._eventHandles,function(_6){dojo.disconnect(_6);});this._eventHandles=new Array([]);},_onClickDeleteLink:function(){this.unit.requestDeletion();},_onFileInputChange:function(){var _7=this.uploadPaneFactory.createFileUploadRequest({unit:this.unit});this.notifyLastFileInputChanged(_7);},notifyLastFileInputChanged:function(_8){this._addToUploadQueue(_8);},_addToUploadQueue:function(_9){dojo.hitch(_9,(_9.setUnit||function(){}))(this.unit);this.uploadManager.addToUploadQueue(_9);},getSelectedFilename:function(){return this.inputFile.value;},getFileInput:function(){return this.inputFile;},_setupUI:function(){dojo.attr(this.inputFile,"size",this.config_UI.inputWidth);},destroy:function(){this._unregisterEvents();this.inherited(arguments);}});}