/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["multiplefileuploader.widget.UploadUnitContainer"]){dojo._hasResource["multiplefileuploader.widget.UploadUnitContainer"]=true;dojo.provide("multiplefileuploader.widget.UploadUnitContainer");dojo.require("multiplefileuploader.widget.UploadActions");dojo.declare("multiplefileuploader.widget.UploadUnitContainer",null,{constructor:function(_1,_2,_3){dojo.mixin(this,_1);this._uploadUnits=new dojox.collections.ArrayList();this._containerDiv=_2;this._uploadActionsContainer=_3;this.createUploadUnit();this._uploadActions=this._createUploadActions();this._lastUploadUnit=null;},_notifyUploadUnitDeleted:function(_4){this._uploadUnits.remove(_4);_4.destroy();this._makeSureOneUploadUnitIsVisible();this._makeSureDeleteLinkIsHiddenForTheFirstInput();},_notifyUnitFailureRecoverable:function(){this._uploadActions.showRetryUploadsLink();},notifyLastFileInputChanged:function(_5){this._getLastElement(this._uploadUnits).notifyLastFileInputChanged(_5);},_makeSureOneUploadUnitIsVisible:function(){if(this._noFileInputVisible()){this.createUploadUnit();}},_makeSureDeleteLinkIsHiddenForTheFirstInput:function(){if(this._oneFileInputVisible()){this._getFirstUnit().hideDeleteLink();}else{dojo.forEach(this._uploadUnits.toArray(),function(u){u.showDeleteLink();});}},createUploadUnit:function(){var _7={config_status:this.config_status,config_UI:this.config_UI,uploadManager:this.uploadManager,onUploadUnitDeletion:dojo.hitch(this,function(_8){this._notifyUploadUnitDeleted(_8);}),onUnitFailureRecoverable:dojo.hitch(this,function(){this._notifyUnitFailureRecoverable();})};var _9=document.createElement("div");dojo.place(_9,this._containerDiv);var _a=new multiplefileuploader.widget.UploadUnit(_7,_9);this._uploadUnits.add(_a);this._makeSureDeleteLinkIsHiddenForTheFirstInput();},_createUploadActions:function(){return new multiplefileuploader.widget.UploadActions({uploadUnitContainer:this,uploadManager:this.uploadManager},this._uploadActionsContainer);},_noFileInputVisible:function(){return (this._uploadUnits.count==0)?true:false;},_oneFileInputVisible:function(){return (this._uploadUnits.count==1)?true:false;},_getFirstUnit:function(){return this._getFirstElement(this._uploadUnits);},_getFirstElement:function(_b){var _c=_b.getIterator();_c.get();return _c.element;},_getLastElement:function(_d){var _e=_d.getIterator();while(!_e.atEnd()){_e.get();}return _e.element;}});}