/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["multiplefileuploader.widget.UploadStatusStrategy"]){dojo._hasResource["multiplefileuploader.widget.UploadStatusStrategy"]=true;dojo.provide("multiplefileuploader.widget.UploadStatusStrategy");dojo.require("dojo.io.iframe");dojo.declare("multiplefileuploader.widget.UploadStatusStrategy",null,{constructor:function(_1){this._config_status=_1;this._temporaryUploadForm=null;this._createTemporaryForm();},getStatus:function(_2,_3){dojo.xhrGet({url:this._config_status.uploadStatusURL+"?"+this._config_status.statusParameterName+"="+_3.getAssociatedID(),timeout:this._config_status.statusTimeout,handleAs:"text",handle:dojo.hitch(this,function(_4){dojox.data.dom.removeChildren(this._temporaryUploadForm);_2.onStatusSuccess(_4);}),error:dojo.hitch(this,function(_5){console.debug("response error!! !! in getStatus()");dojox.data.dom.removeChildren(this._temporaryUploadForm);_2.onStatusError(_5);})});},getID:function(_6){dojo.io.iframe.send({url:this._config_status.uploadStatusURL,form:this._temporaryUploadForm,handleAs:"text",load:dojo.hitch(this,function(_7){console.debug("on getID response success");dojox.data.dom.removeChildren(this._temporaryUploadForm);_6.onIDSuccess(_7);}),error:dojo.hitch(this,function(_8){dojox.data.dom.removeChildren(this._temporaryUploadForm);_6.onIDError(_8);})});},_createTemporaryForm:function(){if(dojo.isIE){this._temporaryUploadForm=document.createElement("<form style=\"display:none\" method=\"post\">");}else{this._temporaryUploadForm=document.createElement("form");dojo.style(this._temporaryUploadForm,{display:"none"});}dojo.body().appendChild(this._temporaryUploadForm);}});}